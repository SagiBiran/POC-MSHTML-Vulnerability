import psutil


def inspect_and_terminate():
    # Iterate over all running process
    for proc in psutil.process_iter():
        if proc.name() == "WINWORD.EXE":
            try:
                if psutil.Process(proc.pid).children():
                    print("[!] Checking For Malware process...")
                    if psutil.Process(proc.pid).children()[0].name() == 'control.exe' and ".cpl:123," in \
                            psutil.Process(proc.pid).children()[0].cmdline()[1]:
                        print("[*] Command-lines executed by control.exe: ", end="")
                        print(psutil.Process(proc.pid).children()[0].cmdline())
                        proc.kill()
                        print("[!] Malware Has Been Detected, process has been killed!")
            except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess) as exception:
                print("[?] " + exception)


def main():
    print("[!] Starting protection overview...")
    while True:
        inspect_and_terminate()


if __name__ == "__main__":
    main()